<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>File-based E-Commerce</title>

    <link rel="stylesheet" href="/frontend/css/output.css">
</head>

<body>
    <header>
        <nav>
            <!-- Navigate the seas here! -->
        </nav>
    </header>

    <!-- Hero Section -->
    
    <!-- Main -->
    <section id="catalog">
        <ol id="products-here"></ol>
    </section>

    <!-- Footer -->
    <footer></footer>

    <script src="/frontend/dist/main.js"></script>

    <!-- Will convert to TS later. Just a proof of concept -->
    <script>

        // JavaScript (DOM Manipulation) with XML
        const populateCatalog = (xmlDoc) => {
            const catalog = document.getElementById("products-here");
            catalog.innerHTML = ""; // Clears catalog

            let products = xmlDoc.getElementsByTagName("product");
            for (let i = 0; i < products.length; i++) {
                let productName = products[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;
                let productImg = products[i].getElementsByTagName("img")[0].childNodes[0].nodeValue;

                catalog.innerHTML += `<li>${productName}</li>`;
                catalog.innerHTML += `<img src="/api/get_image.php?imgName=${productImg}" alt="" />`
            }
        };

        // AJAX with XML
        const getProductsAjax = () => {
            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = () => {
                if ((xhr.readyState == 4) && (xhr.status == 200)) {
                    populateCatalog(xhr.responseXML);
                }
            };

            xhr.open("GET", "/api/get_all_products.php", true);
            xhr.send();
        };

        window.onload = () => {
            getProductsAjax();            
        };
    </script>
</body>
</html>